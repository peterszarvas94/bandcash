service: bandcash
image: peterszarvashu/bandcash

servers:
  - bandcash

proxy:
  host: bandcash.app
  app_port: 2222
  ssl: true
  healthcheck:
    path: /health
    interval: 3
    timeout: 5

registry:
  username:
    - KAMAL_REGISTRY_USERNAME
  password:
    - KAMAL_REGISTRY_PASSWORD

builder:
  arch: amd64
  remote: ssh://peti@bandcash
  local: false

ssh:
  user: peti

volumes:
  - bandcash_data:/storage

env:
  clear:
    APP_ENV: production
    PORT: "2222"
    URL: https://bandcash.app
    DB_PATH: /storage/sqlite.db
    LOG_LEVEL: info
    LOG_FOLDER: /storage/logs
    LOG_PREFIX: bandcash
  secret:
    - SMTP_HOST
    - SMTP_PORT
    - SMTP_USERNAME
    - SMTP_PASSWORD
    - EMAIL_FROM

accessories:
  dozzle:
    service: dozzle
    image: amir20/dozzle:v8.14.8
    host: bandcash
    port: "127.0.0.1:8088:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    env:
      clear:
        DOZZLE_LEVEL: info
        DOZZLE_NO_ANALYTICS: "true"
