{{define "show"}}
<!doctype html>
<html lang="en">
  {{template "head" .}}
  <body>
    <main id="app">
      <h1>{{.Title}}</h1>
      <p><a href="/entry">Back to Entries</a></p>

      <div class="entry-details">
        <p><strong>Title:</strong> {{.Entry.Title}}</p>
        <p><strong>Time:</strong> {{.Entry.Time}}</p>
        <p><strong>Description:</strong> {{.Entry.Description}}</p>
        <p><strong>Amount:</strong> {{printf "%.2f" .Entry.Amount}}</p>
      </div>

      <p class="row">
        <a href="/entry/{{.Entry.ID}}/edit">Edit</a>
        <button
          data-on:click="@delete('/entry/{{.Entry.ID}}')"
        >
          Delete
        </button>
      </p>

      <h2>Participants</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Payee</th>
            <th>Description</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          {{range .Participants}}
          <tr>
            <td><a href="/payee/{{.ID}}">{{.Name}}</a></td>
            <td>{{.Description}}</td>
            <td class="text-right">{{printf "%.2f" .ParticipantAmount}}</td>
          </tr>
          {{end}}
        </tbody>
      </table>

      <div data-signals="{showAddParticipant: false}">
        <p class="row">
          <button type="button" data-on:click="$showAddParticipant = true">
            Add participant
          </button>
        </p>

        <form
          class="form"
          data-on:submit="@post('/entry/{{.Entry.ID}}/participants')"
          data-show="$showAddParticipant"
          style="display: none;"
        >
          <div>
            <label>Payee</label>
            <select name="payee_id" data-bind="payee_id" required>
              <option value="">Select payee</option>
              {{range .Payees}}
              <option value="{{.ID}}">{{.Name}}</option>
              {{end}}
            </select>
          </div>
          <div>
            <label>Amount</label>
            <input
              type="number"
              name="amount"
              data-bind="amount"
              step="0.01"
              required
            />
          </div>
          <div class="row">
            <button type="submit">Add</button>
            <button type="button" data-on:click="$showAddParticipant = false">
              Cancel
            </button>
          </div>
        </form>
      </div>

    </main>
  </body>
</html>
{{end}}
